<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Adding Tests - sui-notes</title>


        <!-- Custom HTML head -->
        <meta name="robots" content="noindex">

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Foreword</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Overview</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../what-is-move.html"><strong aria-hidden="true">3.1.</strong> What is Move</a></li><li class="chapter-item expanded "><a href="../what-is-sui.html"><strong aria-hidden="true">3.2.</strong> What is Sui</a></li><li class="chapter-item expanded "><a href="../history.html"><strong aria-hidden="true">3.3.</strong> History</a></li><li class="chapter-item expanded "><a href="../fast-path.html"><strong aria-hidden="true">3.4.</strong> Fast Path</a></li><li class="chapter-item expanded "><a href="../consensus.html"><strong aria-hidden="true">3.5.</strong> Consensus</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Getting Started</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../install-sui.html"><strong aria-hidden="true">4.1.</strong> Install Sui</a></li><li class="chapter-item expanded "><a href="../ide-support.html"><strong aria-hidden="true">4.2.</strong> Set up your IDE</a></li><li class="chapter-item expanded "><a href="../project-setup.html"><strong aria-hidden="true">4.3.</strong> Project Setup</a></li><li class="chapter-item expanded "><a href="../package-manifest.html"><strong aria-hidden="true">4.4.</strong> Manifest</a></li></ol></li><li class="chapter-item expanded "><a href="../your-first-move/your-first-move.html"><strong aria-hidden="true">5.</strong> Your First Move</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../your-first-move/hello-world.html"><strong aria-hidden="true">5.1.</strong> Hello World!</a></li><li class="chapter-item expanded "><a href="../your-first-move/adding-tests.html" class="active"><strong aria-hidden="true">5.2.</strong> Adding Tests</a></li><li class="chapter-item expanded "><a href="../your-first-move/debugging.html"><strong aria-hidden="true">5.3.</strong> Debugging</a></li><li class="chapter-item expanded "><a href="../your-first-move/generating-docs.html"><strong aria-hidden="true">5.4.</strong> Generating Docs</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">5.5.</strong> Publishing</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.</strong> Syntax Basics</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../modules.html"><strong aria-hidden="true">6.1.</strong> Module</a></li><li class="chapter-item expanded "><a href="../comments.html"><strong aria-hidden="true">6.2.</strong> Comments</a></li><li class="chapter-item expanded "><a href="../address.html"><strong aria-hidden="true">6.3.</strong> Address</a></li><li class="chapter-item expanded "><a href="../primitive-types.html"><strong aria-hidden="true">6.4.</strong> Primitive Types</a></li><li class="chapter-item expanded "><a href="../expression-and-scope.html"><strong aria-hidden="true">6.5.</strong> Expression and Scope</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.6.</strong> Control Flow</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../if.html"><strong aria-hidden="true">6.6.1.</strong> If</a></li><li class="chapter-item expanded "><a href="../loop.html"><strong aria-hidden="true">6.6.2.</strong> Loop</a></li><li class="chapter-item expanded "><a href="../while.html"><strong aria-hidden="true">6.6.3.</strong> While</a></li></ol></li><li class="chapter-item expanded "><a href="../constants.html"><strong aria-hidden="true">6.7.</strong> Constants</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.8.</strong> Error Handling</div></li><li class="chapter-item expanded "><a href="../function.html"><strong aria-hidden="true">6.9.</strong> Function</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.10.</strong> Visibility</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">6.10.1.</strong> Public and Entry</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.10.2.</strong> Friend</div></li></ol></li><li class="chapter-item expanded "><a href="../imports.html"><strong aria-hidden="true">6.11.</strong> Imports</a></li><li class="chapter-item expanded "><a href="../struct.html"><strong aria-hidden="true">6.12.</strong> Struct</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">6.13.</strong> Standard Library</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../managing-collections-with-vectors.html"><strong aria-hidden="true">6.13.1.</strong> Vector</a></li><li class="chapter-item expanded "><a href="../option.html"><strong aria-hidden="true">6.13.2.</strong> Option</a></li><li class="chapter-item expanded "><a href="../string.html"><strong aria-hidden="true">6.13.3.</strong> String</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.</strong> It starts with an Object</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.1.</strong> What is an Object</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.2.</strong> True Ownership</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.3.</strong> Transfer Restrictions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.4.</strong> Shared State</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">7.4.1.</strong> Freezing an Object</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.4.2.</strong> Mutable Shared State</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.5.</strong> Transfer to Object?</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">7.6.</strong> Dynamic Fields</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.</strong> Know the Context</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">8.1.</strong> Epochs</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">8.2.</strong> Sender</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.</strong> Patterns</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">9.1.</strong> Getters and Setters</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.2.</strong> Capability</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.3.</strong> Witness</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.4.</strong> Abstract Class</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.5.</strong> Hot Potato</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">9.6.</strong> Request + Policy</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.</strong> Sui Framework</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">10.1.</strong> TxContext</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.2.</strong> String</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.3.</strong> Url</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.4.</strong> Choose a Collection type</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.5.</strong> VecSet</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.6.</strong> VecMap</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.7.</strong> vector</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.8.</strong> Dynamic Fields</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.9.</strong> Table</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.10.</strong> Linked Table</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.11.</strong> Testing</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.12.</strong> Test Scenario</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.13.</strong> Transfer</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.14.</strong> Cryptography</div></li><li class="chapter-item expanded "><a href="../hashes.html"><strong aria-hidden="true">10.15.</strong> Hashes</a></li><li class="chapter-item expanded "><a href="../clock.html"><strong aria-hidden="true">10.16.</strong> Clock</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.17.</strong> Randomness</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.18.</strong> Freeze Object</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.19.</strong> TypeName and Reflection</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.20.</strong> ID and UID</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.21.</strong> Public Transfer Functions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.22.</strong> Share Object</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.23.</strong> Key Ability and UID</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.24.</strong> Move BCS</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.25.</strong> Balance</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.26.</strong> Coin</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.27.</strong> Token</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.28.</strong> Capability</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.29.</strong> Coding Conventions</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.30.</strong> Error Constants</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.31.</strong> Kiosk</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">10.32.</strong> Transfer Policy</div></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">sui-notes</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="adding-tests"><a class="header" href="#adding-tests">Adding Tests</a></h1>
<p>To run a Move program there needs to be an environment which stores packages and executes transactions. The best way to test a Move program is to write some tests and run them locally. Move has built-in testing functionality, and the tests are written in Move as well. In this section, we will learn how to write tests for our <code>hello_world</code> module.</p>
<p>First, let's try to run tests. All of the Move binaries support the <code>test</code> command, and this is the command we will use to run tests:</p>
<pre><code class="language-bash">$ sui move test
</code></pre>
<p>If you see similar output, then everything is fine, and the test command has run successfully:</p>
<pre><code class="language-bash">INCLUDING DEPENDENCY MoveStdlib
BUILDING Book Samples
Running Move unit tests
Test result: OK. Total tests: 0; passed: 0; failed: 0
</code></pre>
<p>As you can see, the test command has run successfully, but it didn't find any tests. Let's add some tests to our module.</p>
<h2 id="your-first-test"><a class="header" href="#your-first-test">Your first test</a></h2>
<p>When the test command runs, it looks for all tests in all files in the directory. Tests can be either placed separate modules or in the same module as the code they test. First, let's add a test function to the <code>hello_world</code> module:</p>
<pre><code class="language-Move">module book::hello_world {
    use std::string::{Self, String};

    public fun hello_world(): String {
        string::utf8(b&quot;Hello, World!&quot;)
    }

    #[test]
    fun test_is_hello_world() {
        let expected = string::utf8(b&quot;Hello, World!&quot;);
        assert!(hello_world() == expected, 0)
    }
}
</code></pre>
<p>The test function is a function with a <code>#[test]</code> attribute. Normally it takes no arguments (but it can take arguments in some cases - you'll learn more about it closer to the end of this book) and returns nothing. Tests placed in the same module as the code they test are called &quot;unit tests&quot;. They can access all functions and types in the module. We'll go through them in more detail in the <a href="../syntax-basics/test.html">Test</a> section.</p>
<pre><code class="language-Move">    #[test]
    fun test_is_hello_world() {
        let expected = string::utf8(b&quot;Hello, World!&quot;);
        assert!(hello_world() == expected, 0)
    }
</code></pre>
<p>Inside the test function, we define the expected outcome by creating a String with the expected value and assign it to the <code>expected</code> variable. Then we use the special built-in <code>assert!()</code> which takes two arguments: a conditional expression and an error code. If the expression evaluates to <code>false</code>, then the test fails with the given error code. The equality operator <code>==</code> compares the <code>actual</code> and <code>expected</code> values and returns <code>true</code> if they are equal. We'll learn more about expressions in the <a href="../syntax-basics/expression-and-scope.html">Expression and Scope</a> section.</p>
<p>Now let's run the test command again:</p>
<pre><code class="language-bash">$ sui move test
</code></pre>
<p>You should see this output, which means that the test has run successfully:</p>
<pre><code class="language-bash">...
Test result: OK. Total tests: 1; passed: 1; failed: 0
</code></pre>
<h2 id="failed-experiment"><a class="header" href="#failed-experiment">Failed experiment</a></h2>
<p>Try replacing the equality operator  <code>==</code> inside the <code>assert!</code> with the inequality operator <code>!=</code> and run the test command again.</p>
<pre><code class="language-Move">    assert!(hello_world() != expected, 0)
</code></pre>
<p>You should see this output, which means that the test has failed:</p>
<pre><code class="language-bash">Running Move unit tests
[ FAIL    ] 0x0::hello_world::test_is_hello_world

Test failures:

Failures in 0x0::hello_world:

┌── test_is_hello_world ──────
│ error[E11001]: test failure
│    ┌─ ./sources/your-first-move/hello_world.move:14:9
│    │
│ 12 │     fun test_is_hello_world() {
│    │         ------------------- In this function in 0x0::hello_world
│ 13 │         let expected = string::utf8(b&quot;Hello, World!&quot;);
│ 14 │         assert!(hello_world() != expected, 0)
│    │         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ Test was not expected to error, but it aborted with code 0 originating in the module 00000000000000000000000000000000::hello_world rooted here
│
│
└──────────────────

Test result: FAILED. Total tests: 1; passed: 0; failed: 1
</code></pre>
<p>Tests are used to verify the execution of the code. If the code is correct, the test should pass, otherwise it should fail. In this case, the test failed because we intentionally made a mistake in the test code. However, normally you should write tests that check the correctness of the code, not the other way around!</p>
<p>In the next section, we will learn how to debug Move programs and print intermediate values to the console.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../your-first-move/hello-world.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../your-first-move/debugging.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../your-first-move/hello-world.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../your-first-move/debugging.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
